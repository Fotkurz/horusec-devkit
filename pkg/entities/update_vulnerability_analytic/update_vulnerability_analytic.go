package updatevulnerabilityanalytic

import (
	"encoding/json"

	"github.com/ZupIT/horusec-devkit/pkg/entities/update_vulnerability_analytic/enums"

	"github.com/ZupIT/horusec-devkit/pkg/entities/vulnerability"
)

type VulnerabilityToUpdate map[enums.UpdateType]*vulnerability.Vulnerability

func NewVulnerabilityToUpdate(newVuln, oldVuln *vulnerability.Vulnerability) *VulnerabilityToUpdate {
	return &VulnerabilityToUpdate{
		enums.New: newVuln,
		enums.Old: oldVuln,
	}
}

func (v *VulnerabilityToUpdate) ToBytes() []byte {
	bytes, _ := json.Marshal(v)
	return bytes
}
